-- 테이블 순서는 관계를 고려하여 한 번에 실행해도 에러가 발생하지 않게 정렬되었습니다.

-- MEMBER Table Create SQL
CREATE TABLE MEMBER
(
    ID          VARCHAR2(20)    NOT NULL, 
    PWD         VARCHAR2(30)    NOT NULL, 
    NAME        VARCHAR2(20)    NOT NULL, 
    PHONE       VARCHAR2(20)    NOT NULL, 
    EMAIL       VARCHAR2(30)    NOT NULL, 
    NICKNAME    VARCHAR2(30)    NOT NULL, 
    JOINDATE    DATE            NOT NULL, 
    CONSTRAINT MEMBER_PK PRIMARY KEY (ID)
)
;

-- MEMBER Table Create SQL
CREATE TABLE ORD
(
    O_CODE    VARCHAR2(32)    NOT NULL, 
    ID        VARCHAR2(20)    NOT NULL, 
    O_DATE    DATE            NOT NULL, 
    TOTAL     NUMBER          NOT NULL, 
    CONSTRAINT ORD_PK PRIMARY KEY (O_CODE)
)
;


-- MEMBER Table Create SQL
CREATE TABLE PRODUCT
(
    P_CODE        VARCHAR2(32)      NOT NULL, 
    P_NAME        VARCHAR2(64)      NOT NULL, 
    PRICE         NUMBER            NOT NULL, 
    P_SIZE        VARCHAR2(20)      NOT NULL, 
    P_DATE        DATE              NOT NULL, 
    P_CATEGORY    VARCHAR2(32)      NOT NULL, 
    P_DETAIL      VARCHAR2(2000)    NOT NULL, 
    A_ID          VARCHAR2(20)      NOT NULL, 
    CONSTRAINT PRODUCT_PK PRIMARY KEY (P_CODE)
)
;

COMMENT ON COLUMN PRODUCT.P_DATE IS 'DEFAULT SYSDATE'
;

ALTER TABLE PRODUCT
    ADD CONSTRAINT FK_PRODUCT_A_ID_MEMBER_ID FOREIGN KEY (A_ID)
        REFERENCES MEMBER (ID)
;


-- MEMBER Table Create SQL
CREATE TABLE ADMIN
(
    AD_ID     VARCHAR2(64)    NOT NULL, 
    AD_PWD    VARCHAR2(30)    NOT NULL, 
    CONSTRAINT ADMIN_PK PRIMARY KEY (AD_ID)
)
;


-- MEMBER Table Create SQL
CREATE TABLE DELIVERY
(
    P_CODE       VARCHAR2(32)     NOT NULL, 
    D_ADDRESS    VARCHAR2(256)    NOT NULL, 
    D_POST       NUMBER           NOT NULL, 
    ID           VARCHAR2(20)     NOT NULL, 
    O_CODE       VARCHAR2(32)     NOT NULL
)
;

ALTER TABLE DELIVERY
    ADD CONSTRAINT FK_DELIVERY_O_CODE_ORD_O_CODE FOREIGN KEY (O_CODE)
        REFERENCES ORD (O_CODE)
;

ALTER TABLE DELIVERY
    ADD CONSTRAINT FK_DELIVERY_ID_MEMBER_ID FOREIGN KEY (ID)
        REFERENCES MEMBER (ID)
;


-- MEMBER Table Create SQL
CREATE TABLE ADDRESS
(
    ID               VARCHAR2(20)     NOT NULL, 
    A_NAME           VARCHAR2(50)     NOT NULL, 
    POST             NUMBER           NOT NULL, 
    ADDRESS          VARCHAR2(258)    NOT NULL, 
    EXTRA_ADDRESS    VARCHAR2(258)    NOT NULL
)
;

ALTER TABLE ADDRESS
    ADD CONSTRAINT FK_ADDRESS_ID_MEMBER_ID FOREIGN KEY (ID)
        REFERENCES MEMBER (ID)
;


-- MEMBER Table Create SQL
CREATE TABLE ARTIST
(
    A_ID        VARCHAR2(20)     NOT NULL, 
    NICKNAME    VARCHAR2(30)     NOT NULL, 
    A_DETAIL    VARCHAR2(256)    NULL   
)
;

ALTER TABLE ARTIST
    ADD CONSTRAINT FK_ARTIST_A_ID_MEMBER_ID FOREIGN KEY (A_ID)
        REFERENCES MEMBER (ID)
;


-- MEMBER Table Create SQL
CREATE TABLE WISHLIST
(
    P_CODE    VARCHAR2(32)    NOT NULL, 
    ID        VARCHAR2(20)    NOT NULL
)
;

ALTER TABLE WISHLIST
    ADD CONSTRAINT FK_WISHLIST_ID_MEMBER_ID FOREIGN KEY (ID)
        REFERENCES MEMBER (ID)
;

ALTER TABLE WISHLIST
    ADD CONSTRAINT FK_WISHLIST_P_CODE_PRODUCT_P_C FOREIGN KEY (P_CODE)
        REFERENCES PRODUCT (P_CODE)
;


-- MEMBER Table Create SQL
CREATE TABLE STEP
(
    O_CODE    VARCHAR2(32)    NOT NULL, 
    STEP      VARCHAR2(32)    NOT NULL
)
;

ALTER TABLE STEP
    ADD CONSTRAINT FK_STEP_O_CODE_ORD_O_CODE FOREIGN KEY (O_CODE)
        REFERENCES ORD (O_CODE)
;


-- MEMBER Table Create SQL
CREATE TABLE FOLLOW
(
    ID      VARCHAR2(20)    NOT NULL, 
    A_ID    VARCHAR2(20)    NOT NULL
)
;

ALTER TABLE FOLLOW
    ADD CONSTRAINT FK_FOLLOW_ID_MEMBER_ID FOREIGN KEY (ID)
        REFERENCES MEMBER (ID)
;


-- MEMBER Table Create SQL
CREATE TABLE S_ORD
(
    O_CODE    VARCHAR2(32)    NOT NULL, 
    P_CODE    VARCHAR2(32)    NOT NULL, 
    A_ID      VARCHAR2(20)    NOT NULL
)
;

ALTER TABLE S_ORD
    ADD CONSTRAINT FK_S_ORD_O_CODE_ORD_O_CODE FOREIGN KEY (O_CODE)
        REFERENCES ORD (O_CODE)
;

ALTER TABLE S_ORD
    ADD CONSTRAINT FK_S_ORD_P_CODE_PRODUCT_P_CODE FOREIGN KEY (P_CODE)
        REFERENCES PRODUCT (P_CODE)
;


-- MEMBER Table Create SQL
CREATE TABLE P_IMAGE
(
    P_CODE         VARCHAR2(32)    NOT NULL, 
    PI_FILENAME    VARCHAR2(50)    NOT NULL, 
    PI_CODE        VARCHAR2(32)    NOT NULL, 
    PI_FILETYPE    VARCHAR2(40)    NOT NULL, 
    A_ID           VARCHAR2(20)    NOT NULL
)
;

ALTER TABLE P_IMAGE
    ADD CONSTRAINT FK_P_IMAGE_P_CODE_PRODUCT_P_CO FOREIGN KEY (P_CODE)
        REFERENCES PRODUCT (P_CODE)
;

ALTER TABLE P_IMAGE
    ADD CONSTRAINT FK_P_IMAGE_A_ID_MEMBER_ID FOREIGN KEY (A_ID)
        REFERENCES MEMBER (ID)
;


-- MEMBER Table Create SQL
CREATE TABLE A_IMAGE
(
    A_ID           VARCHAR2(20)    NOT NULL, 
    AI_FILENAME    VARCHAR2(50)    NOT NULL, 
    AI_CODE        VARCHAR2(32)    NOT NULL
)
;

ALTER TABLE A_IMAGE
    ADD CONSTRAINT FK_A_IMAGE_A_ID_MEMBER_ID FOREIGN KEY (A_ID)
        REFERENCES MEMBER (ID)
;

CREATE SEQUENCE SEQ_P_CODE INCREMENT BY 1 MAXVALUE 1000000 MINVALUE 100 CACHE 20 ORDER;
CREATE SEQUENCE SEQ_PI_CODE  MINVALUE 1 MAXVALUE 11111111 INCREMENT BY 1 START WITH 30 NOCACHE  NOORDER  NOCYCLE ;
CREATE SEQUENCE SEQ_AI_CODE INCREMENT BY 1 MAXVALUE 1000000 MINVALUE 100 CACHE 20 ORDER;


COMMIT;
